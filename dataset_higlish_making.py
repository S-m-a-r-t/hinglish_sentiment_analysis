# -*- coding: utf-8 -*-
"""dataset_higlish.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/14-LL7EzVAxjJCfYwcS99X1Q41SkBh6ye
"""

import json
import csv

input_file = "/content/hinglish_upload_v1.json"       # your JSON file
output_file = "hinglish_texts.csv"  # CSV output file

hi_ng_list = []

# Read JSONL file line by line
with open(input_file, "r", encoding="utf-8") as f:
    for line in f:
        if line.strip():  # skip empty lines
            data = json.loads(line)
            hi_ng = data["translation"]["hi_ng"]
            hi_ng_list.append(hi_ng)

# Write hi_ng values into CSV
with open(output_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(["hi_ng"])  # header
    for text in hi_ng_list:
        writer.writerow([text])

print(f"✅ Extracted {len(hi_ng_list)} hi_ng values and saved to {output_file}")

import csv

input_file = "/content/hinglish_texts.csv"               # your input CSV file
output_file = "hinglish_texts_filtered.csv"  # filtered output CSV

hi_ng_list = []

# Read CSV file
with open(input_file, "r", encoding="utf-8") as f:
    reader = csv.DictReader(f)
    for row in reader:
        hi_ng = row.get("hi_ng", "").strip()
        # Keep only sentences with >= 10 words
        if len(hi_ng.split()) >= 8:
            hi_ng_list.append(hi_ng)

# Write filtered data into new CSV
with open(output_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(["hi_ng"])  # header

    for text in hi_ng_list:
        writer.writerow([text])

    # Add final row with total count
    writer.writerow([])
    writer.writerow(["Total sentences", len(hi_ng_list)])

print(f"✅ Saved {len(hi_ng_list)} filtered hi_ng values to {output_file}")

import csv
import re

input_file = "/content/hinglish_texts_filtered.csv"                # your input CSV
output_file = "hinglish_texts_filtered_2.csv"  # filtered output CSV

hi_ng_list = []

# Regex for removing symbols (keep only letters, numbers, and spaces)
clean_pattern = re.compile(r'[^a-zA-Z\s]')

# Read CSV
with open(input_file, "r", encoding="utf-8") as f:
    reader = csv.DictReader(f)
    for row in reader:
        hi_ng = row.get("hi_ng", "").strip()

        # Skip if contains any digit
        if any(char.isdigit() for char in hi_ng):
            continue

        # Remove unwanted symbols
        hi_ng_clean = clean_pattern.sub("", hi_ng)

        # Keep only if word count >= 8
        if len(hi_ng_clean.split()) >= 8:
            hi_ng_list.append(hi_ng_clean)

# Write filtered data into new CSV
with open(output_file, "w", newline="", encoding="utf-8") as f:
    writer = csv.writer(f)
    writer.writerow(["hi_ng"])  # header

    for text in hi_ng_list:
        writer.writerow([text])

    # Add final row with total count
    writer.writerow([])
    writer.writerow(["Total sentences", len(hi_ng_list)])

print(f"✅ Saved {len(hi_ng_list)} cleaned and filtered hi_ng sentences to {output_file}")